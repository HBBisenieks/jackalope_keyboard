points:
  zones:
    matrix:
      anchor:
        rotate: 5
      columns:
        outer:
          rows:
            bottom:
            home:
            top:
        pinky:
          rows:
            bottom:
            home:
            top:
        ring:
          rotate: -4
          origin: [-12, -19]
          stagger: 12
          rows:
            bottom:
            home:
            top:
        middle:
          stagger: 5
          rows:
            bottom:
            home:
            top:
        index:
          stagger: -6
          rows:
            bottom:
            home:
            top:
        inner:
          stagger: -2
          rows:
            bottom:
            home:
            top:
        macro:
          stagger: 15
          rows:
            home:
            top:
    thumb_cluster:
      anchor:
        ref: matrix_inner_bottom
        shift: [-7, -25]
      columns:
        inner:
          rows:
            lower:
        home:
          stagger: -5
          rows:
            upper:
            lower:
          spread: 21.25
          rotate: -18
          origin: [-11.75, -9]
        outer:
          rows:
            upper:
            lower:
          spread: 21.25
          rotate: -6
          origin: [-9.5, -9]
  rotate: -15
  mirror:
    ref: matrix_outer_home
    distance: 295
outlines:
  glue:
    jackalope_1p_outline:
      top:
        left:
          ref: matrix_ring_top
          shift: [, 0.5 sy]
        right:
          ref: mirror_matrix_ring_top
          shift: [, 0.5 sy]
      bottom:
        left:
          ref: thumb_cluster_outer_lower
          shift: [.5 sx, 0]
          rotate: 90
        right:
          ref: mirror_thumb_cluster_outer_lower
          shift: [0.5 sx, 0]
          rotate: 90
      waypoints:
        - percent: 50
          width: 50
        - percent: 90
          width: 25
  exports:
    jackalope_1p_pcb:
      main:
        type: keys
        side: both
        glue: jackalope_1p_outline
        size: 40
        corner: 1.5
    filler:
      - type: polygon
        points:
          - ref: matrix_outer_top
            shift: [-19, 20]
          - ref: matrix_pinky_top
            shift: [5, 32.1]
          - ref: matrix_ring_top
            shift: [0, 25]
          - ref: matrix_ring_top
        mirror: true
      - type: polygon
        points:
          - ref: matrix_pinky_bottom
            shift: [-9.5, -20]
          - ref: thumb_cluster_inner_lower
            shift: [-19, -20]
          - ref: thumb_cluster_inner_lower
            shift: [0, -22.4]
          - ref: thumb_cluster_inner_lower
            shift: 1
          - ref: matrix_pinky_bottom
            shift: [20, 0]
        mirror: true
    jackalope_1p_case_plate:
      main:
        type: outline
        name: jackalope_1p_pcb
        fillet: 1.5
      filler:
        type: outline
        name: filler
        operation: add
    jackalope_1p_swithces:
      main:
        type: keys
        side: both
        glue: jackalope_1p_case_plate 
        size: 14
        bound: false
    jackalope_1p_outer:
      main:
        type: keys
        side: both
        glue: jackalope_1p_outline
        size: 18
        corner: .5
    jackalope_1p_inner:
      main:
        type: keys
        side: both
        glue: jackalope_1p_outline
        size: 14
    jackalope_1p_body:
      - +jackalope_1p_outer
      - -jackalope_1p_inner
    mounting_holes:
      outer_top:
        type: circle
        anchor:
          ref: matrix_outer_top
          shift: [-13, 13]
        radius: 2.25
        mirror: true 
      outer_bottom:
        type: circle
        anchor:
          ref: matrix_outer_bottom
          shift: [-13, -13]
        radius: 2.25
        mirror: true
        operation: stack
      ring_top:
        type: circle
        anchor:
          ref: matrix_ring_top
          shift: [-13, 13]
        radius: 2.25
        mirror: true
        operation: stack
      pinky_bottom:
        type: circle
        anchor:
          ref: matrix_pinky_bottom
          shift: [13, -13]
        radius: 2.25
        mirror: true
        operation: stack
      index_top:
        type: circle
        anchor:
          ref: matrix_index_top
          shift: [9.5, 13]
        radius: 2.25
        mirror: true
        operation: stack
      index_bottom:
        type: circle
        anchor:
          ref: thumb_cluster_inner_lower
          shift: [-13, -13]
        radius: 2.25
        mirror: true
        operation: stack
      thumb_outer:
        type: circle
        anchor:
          ref: thumb_cluster_outer_upper
          shift: [13, -13]
        radius: 2.25
        mirror: true
        operation: stack
    screw_holes_3d:
      $extends: outlines.exports.mounting_holes
      outer_top:
        radius: 2
      outer_bottom:
        radius: 2
      ring_top:
        radius: 2
      pinky_bottom:
        radius: 2
      index_top:
        radius: 2
      index_bottom:
        radius: 2
      thumb_outer:
        radius: 2
    screw_holes:
      $extends: outlines.exports.mounting_holes
      outer_top:
        radius: 1
      outer_bottom:
        radius: 1
      ring_top:
        radius: 1
      pinky_bottom:
        radius: 1
      index_top:
        radius: 1
      index_bottom:
        radius: 1
      thumb_outer:
        radius: 1
    controller_plate_cutout:
      main:
        type: rectangle
        anchor:
          ref:
            - matrix_inner_top
            - mirror_matrix_inner_top
          shift: [-12.5, -30]
        size: [25, 50]
    controller_cutout:
      main:
        type: rectangle
        anchor:
          ref:
            - matrix_inner_top
            - mirror_matrix_inner_top
          shift: [-10, 10]
        size: [20, 10]
    jackalope_1p_plate:
      main:
        type: keys
        side: both
        size: 45
      filler:
        type: outline
        name: filler
        operation: add
      cut_to_size:
        type: outline 
        name: jackalope_1p_case_plate
        operation: intersect
      controller_cutout:
        type: outline
        name: controller_plate_cutout
        operation: subtract
      switches:
        type: outline
        name: jackalope_1p_swithces
        operation: subtract
      screw_holes:
        type: outline
        name: screw_holes
        operation: subtract
    jackalope_1p_bottom:
      base:
        type: outline
        name: jackalope_1p_case_plate
      screw_holes:
        type: outline
        name: screw_holes
        operation: subtract
    jackalope_1p_plate_3d:
      main:
        type: keys
        side: both
        size: 45
      filler:
        type: outline
        name: filler
        operation: add
      cut_to_size:
        type: outline 
        name: jackalope_1p_case_plate
        operation: intersect
      switches:
        type: outline
        name: jackalope_1p_swithces
        operation: subtract
      screw_holes:
        type: outline
        name: screw_holes_3d
        operation: subtract
    jackalope_1p_bottom_3d:
      base:
        type: outline
        name: jackalope_1p_case_plate
      screw_holes:
        type: outline
        name: screw_holes_3d
        operation: subtract
    intersected_outline:
      - +jackalope_1p_pcb
      - -mounting_holes
      - -controller_cutout
    normal_middle: &middle
      raw:
        type: keys
        side: middle
        glue: jackalope_1p_outline
        size: 24
      rect1:
        type: rectangle
        size: [25, 5]
        anchor:
          ref: thumb_cluster_home_upper
          shift: [0, 12]
        mirror: true
      rect2:
        type: rectangle
        size: [25, 5]
        anchor:
          ref: thumb_cluster_outer_upper
          shift: [0, 12]
        mirror: true
      outer_bounds:
        type: outline
        name: jackalope_1p_pcb
        operation: intersect
pcbs:
  jackalope_unibody:
    outlines:
      edge:
        outline: intersected_outline
        layer: Edge.Cuts
      middle:
        outline: normal_middle
        layer: F.SilkS
    footprints:
      mcu:
        type: promicro
        anchor:
          ref:
            - matrix_inner_top
            - mirror_matrix_inner_top
          shift: [0, -8]
          rotate: 270
